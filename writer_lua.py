#! python
# -*- coding:utf-8 -*-

import os
from datetime import datetime

try:
    basestring
except NameError:
    basestring = str

START_ROW = 2

def convertToStr(_value):
    if not isinstance(_value,basestring):
        if _value == int(_value):    #将excel中的float改为int
            _value = int(_value)

        return str(_value)

    #因为生成的是代码，如果是字符串，得加''
    return '\'' + _value.strip( ' ' ) + '\''  #去除左右空格(仅半角)

class Writer:

    def __init__(self,types,fields,rows ):
        self.types  = types
        self.fields = fields
        self.rows   = rows

    def comment(self):
        now = datetime.now()
        comment = '--[[\n'
        comment += 'Do NOT MODITY!  Auto generated by py_exceltools\n'
        comment += 'https://www.python.org/\n'
        comment += 'http://www.python-excel.org/\n'
        comment += ']]\n\n'
        comment += '-- from ' + now.strftime('%Y-%m-%d %H:%M:%S') + '\n'
        return comment

    def content():
        ctx = ""